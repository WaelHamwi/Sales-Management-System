document.addEventListener("DOMContentLoaded",(function(){document.getElementById("order_date").value=function(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}()})),$(document).ready((function(){var t=moment().subtract(29,"days"),e=moment();function a(t,e){$("#reportrange span").html(t.format("MMMM D, YYYY")+" - "+e.format("MMMM D, YYYY"))}$("#reportrange").daterangepicker({startDate:t,endDate:e,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}},a),a(t,e)})),$(document).ready((function(){$("#reportrange").on("apply.daterangepicker",((t,e)=>{var a=$("#reportrange").text(),[n,o]=a.split("-"),n=new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).split("/").reverse().join("-").replace(/^(\d{4})-(\d{2})-(\d{2})$/,"$1-$3-$2"),o=new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).split("/").reverse().join("-").replace(/^(\d{4})-(\d{2})-(\d{2})$/,"$1-$3-$2"),i=$("#company_id").val();""!==i?$.ajax({url:"/get-count-of-branch-sales-daterange/"+i,type:"get",data:{startDate:n,endDate:o,_token:$('meta[name="csrf-token"]').attr("content")},success:function(t){countOfSuccessSales.text(t)},error:function(t,e,a){countOfSuccessSales.text(0)}}):$.ajax({url:"/get-count-of-sales-daterange-AllCompanies",type:"get",data:{startDate:n,endDate:o,_token:$('meta[name="csrf-token"]').attr("content")},success:function(t){countOfSuccessSales.text(t)},error:function(t,e,a){}})}))})),$(document).ready((function(){$("#company_id").change((function(){var t=$(this).val(),e=$("#branch_id");e.empty(),""!==t?$.ajax({url:"/get-branches/"+t,type:"GET",success:function(t){$.each(t,(function(t,a){e.append('<option value="'+a.id+'">'+a.name+"</option>")})),$("#branch_select_wrapper").show()},error:function(t,e,a){}}):$("#branch_select_wrapper").hide(),$.ajax({url:"/get-count-of-branch-sales/"+t,type:"get",data:{_token:$('meta[name="csrf-token"]').attr("content")},success:function(t){countOfSuccessSales.text(t)},error:function(t,e,a){}})}))}));var countOfSuccessSales=$(".countOfSuccessSales");function destroy(t,e){t.charAt(0).toUpperCase(),t.slice(1);var a=translations["Are you sure you want to delete this "+t+"?"];alertify.confirm().setting({title:translations.Confirmation,message:a,labels:{ok:translations.Yes,cancel:translations.No},onok:function(){$("#loader").addClass("activate"),$.ajax({url:"/"+("category"===t?"categories":"stock"===t?"stocks":"product"===t?"products":"orderItem"===t?"orderItems":"order"===t?"orders":"companies")+"/"+e,type:"DELETE",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(a){alertify.success(translations["deleting "+t+" done:"]),$("a.delete-button[data-"+t+'-id="'+e+'"]').closest("tr").remove(),$("#loader").removeClass("activate")},error:function(t,e,a){alertify.error(translations["Deletion canceled"]),$("#loader").removeClass("activate")}})},oncancel:function(){}}).show()}$.ajax({url:"/get-count-of-sales",type:"get",data:{_token:$('meta[name="csrf-token"]').attr("content")},success:function(t){countOfSuccessSales.text(t)},error:function(t,e,a){}}),$(document).ready((function(){$(".multiple-select").select2(),$(".multiple-select").change((function(){var t=$(this),e=$("#quantity_fields");e.html("");var a=translations.quantity_for;t.find("option:selected").each((function(){var t=$(this).val(),n=$(this).text(),o=`\n              <div class="form-group ">\n                  <label for="quantity_${t}">${a} ${n}</label>\n                  <input type="number" name="stock_quantity[]" class="form-control " id="quantity_${t}" min="1">\n              </div>\n          `;e.append(o)}))}))})),$(document).ready((function(){$("#company_id").select2(),$("#branch_id").select2(),$("#category_id").select2(),$("#company_id, #branch_id","#category_id").change((function(){var t=$("#company_id"),e=$("#branch_id"),a=$("#category_id");t.val(),t.find("option:selected").text(),e.val(),e.find("option:selected").text(),a.val(),a.find("option:selected").text()}))})),$("#product_id").select2(),$("#product_id").change((function(){var t=$(this),e=$("#quantity_fields"),a=$("#product_price");e.html(""),a.html("");var n=translations.quantity_for,o=translations.product_price_for;t.find("option:selected").each((function(){var t=$(this).val(),i=$(this).text(),l=`\n            <div class="form-group">\n                <label for="quantity_${t}">${n} ${i}</label>\n                <input type="number" name="stock_quantity[]" class="form-control" id="quantity_${t}" min="1">\n            </div>\n        `,s=`\n            <div class="form-group">\n                <label for="productPrice_${t}">${o} ${i}</label>\n                <input type="number" name="product_price[]" class="form-control" id="product_price_${t}" min="1">\n            </div>\n        `;e.append(l),a.append(s)}))})),$("#formSubmitOrders").click((function(t){t.preventDefault(),document.querySelectorAll(".form-control").forEach((function(t){t.classList.remove("is-invalid")}));var e=document.getElementById("order_date").value,a=document.getElementById("company_id").value,n=document.getElementById("branch_id").value,o=document.getElementById("product_id").value.split(",");if(!e)return document.getElementById("order_date").classList.add("is-invalid"),void $.notify(translations.fillorderDate,{globalPosition:globalPosition});if(!a)return document.getElementById("company_id").classList.add("is-invalid"),void $.notify(translations.fillCompany,{globalPosition:globalPosition});if(!n)return document.getElementById("branch_id").classList.add("is-invalid"),void $.notify(translations.fillBranch,{globalPosition:globalPosition});if(!o||0===o.length||""===o[0])return document.getElementById("product_id").classList.add("is-invalid"),void $.notify(translations.selectProduct,{globalPosition:globalPosition});for(var i=!0,l=0;l<o.length;l++){var s=document.querySelector('input[name="stock_quantity[]"]:nth-of-type('+(l+1)+")"),r=document.querySelector('input[name="product_price[]"]:nth-of-type('+(l+1)+")"),d=s.value,c=r.value;if(!d||isNaN(d)||d.length>10){s.classList.add("is-invalid"),$.notify(translations.fillQuantity,{globalPosition:globalPosition}),i=!1;break}if(!c||isNaN(c)||!/^\d{1,16}(\.\d{1,2})?$/.test(c)){r.classList.add("is-invalid"),$.notify(translations.invalidProductPrice,{globalPosition:globalPosition}),i=!1;break}if((d*c).toString().length>9){var u=translations.subtotalExceededLimit.replace("%{productNumber}",l+1);$.notify(u,{globalPosition:globalPosition}),i=!1;break}}i&&($("#loader").addClass("activate"),document.getElementById("formDropzone").submit())})),$("#formSubmitStock").click((function(t){t.preventDefault();var e=$("#product_id").val(),a=!1;$.ajax({url:"/stocks/check-products-exist",type:"POST",data:{productIds:e,_token:$('meta[name="csrf-token"]').attr("content")},success:function(t){t.products.length>0&&$.each(t.products,(function(t,e){e.exists&&($.notify(translations.duplicateProduct+" "+e.name,{globalPosition:globalPosition}),a=!0,$("#loader").removeClass("activate"))})),a||($("#loader").removeClass("active"),$("#stock_form").submit())},error:function(t,e,a){}});var n=document.getElementById("product_id").selectedOptions;e=[],a=!1;if(0===n.length)a=!0,$("#product_id").addClass("is-invalid"),$.notify(translations.selectProduct,{globalPosition:globalPosition});else for(var o=0;o<n.length;o++){var i=n[o].value,l=document.getElementById("quantity_"+i),s=l.value.trim();e.push(i),""===s?(a=!0,$.notify(translations.fillQuantityNumber,{globalPosition:globalPosition}),$(l).addClass("is-invalid")):s.match(/^\d{1,10}$/)||(a=!0,$(l).addClass("is-invalid"),$.notify(translations.invalidQuantityFormat,{globalPosition:globalPosition}))}a&&t.preventDefault(),$('input[name="stock_quantity[]"]').on("input",(function(){$(this).removeClass("is-invalid")}))}));var uploadRoute=document.getElementById("myDropzone").getAttribute("data-upload-route");Dropzone.autoDiscover=!1;var myDropzone=new Dropzone("#myDropzone",{url:uploadRoute,paramName:"file",maxFiles:1,acceptedFiles:".jpeg, .jpg, .png, .gif",dictDefaultMessage:dropzoneTranslations.default_message,dictFallbackMessage:dropzoneTranslations.fallback_message,dictInvalidFileType:dropzoneTranslations.invalid_file_type,dictFileTooBig:dropzoneTranslations.file_too_big,dictResponseError:dropzoneTranslations.response_error,dictCancelUpload:dropzoneTranslations.cancel_upload,dictCancelUploadConfirmation:dropzoneTranslations.cancel_upload_confirmation,dictRemoveFile:dropzoneTranslations.remove_file,dictMaxFilesExceeded:dropzoneTranslations.max_files_exceeded,previewTemplate:$("#dzPreviewContainer").html(),thumbnailWidth:900,thumbnailHeight:600,previewsContainer:"#previews",timeout:0,init:function(){this.on("success",(function(t,e){if(e.success){var a=e.image_name;$("#imageInput2").val(a)}})),this.on("error",(function(t,e){$.notify(e,{globalPosition:globalPosition,className:"error"}),this.removeFile(t)})),this.on("uploadprogress",(function(t,e,a){var n=t.previewElement.querySelector(".dz-upload-container");if(n){var o=n.querySelector(".dz-upload-progress"),i=n.querySelector(".progress-text");o&&i&&(o.style.width=e+"%",i.textContent=e+"%")}}))},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});$(document).ready((function(){$("#formSubmitProduct").click((function(t){$("#loader").addClass("activate"),$(".form-control").removeClass("is-invalid");var e=!1,a=$("#exampleInputName1").val().trim(),n=$("#productPrice").val().trim(),o=$("#productBarcode").val().trim(),i=$("#productSKU").val().trim(),l=$("#imageInput2").val().trim();0===a.length||a.length>35?(e=!0,$("#exampleInputName1").addClass("is-invalid"),$.notify(translations.length_product_name,{globalPosition:globalPosition})):0===n.length||n.length>16?(e=!0,$("#productPrice").addClass("is-invalid"),$.notify(translations.length_product_price,{globalPosition:globalPosition})):/^\d{1,16}(\.\d{1,2})?$/.test(n)?i.length>35?(e=!0,$("#productSKU").addClass("is-invalid"),$.notify(translations.length_product_SKU,{globalPosition:globalPosition})):o.length>35?(e=!0,$("#productBarcode").addClass("is-invalid"),$.notify(translations.length_product_barcode,{globalPosition:globalPosition})):(0===l.length||l.length>45)&&(e=!0,$.notify(translations.image_required,{globalPosition:globalPosition})):(e=!0,$("#productPrice").addClass("is-invalid"),$.notify(translations.invalid_product_price,{globalPosition:globalPosition})),e&&(t.preventDefault(),$("#loader").removeClass("activate"))})),$("#formSubmitBranch").click((function(t){$("#loader").addClass("activate");var e=!1,a=document.getElementById("exampleInputName1").value.trim();0===a.length?(e=!0,document.getElementById("exampleInputName1").classList.add("is-invalid"),$.notify(branchTranslations.fillBranchName,{globalPosition:globalPosition})):a.length>35?(e=!0,document.getElementById("exampleInputName1").classList.add("is-invalid"),$.notify(branchTranslations.branchNameMax,{globalPosition:globalPosition})):/[a-zA-Z]/.test(a)?""===imagePath&&$(".forms-sample").hasClass("imageValidation")&&(t.preventDefault(),$.notify(translations.imageRequired,{globalPosition:globalPosition})):(e=!0,document.getElementById("exampleInputName1").classList.add("is-invalid"),$.notify(branchTranslations.branchNameEnglishLetter,{globalPosition:globalPosition})),e&&(event.preventDefault(),$("#loader").removeClass("activate")),document.getElementById("exampleInputName1").addEventListener("input",(function(){this.classList.remove("is-invalid")}))})),$("#formSubmitCategory").click((function(t){$("#loader").addClass("activate"),document.getElementById("exampleInputName1").classList.remove("is-invalid");var e=!1,a=document.getElementById("exampleInputName1").value.trim(),n=$("#imageInput2").val();0===a.length?(e=!0,document.getElementById("exampleInputName1").classList.add("is-invalid"),$.notify(translations.fillCategoryName,{globalPosition:globalPosition})):a.length>35?(e=!0,document.getElementById("exampleInputName1").classList.add("is-invalid"),$.notify(translations.categoryNameMax,{globalPosition:globalPosition})):""===n&&$(".forms-sample").hasClass("imageValidation")&&(t.preventDefault(),$.notify(translations.imageRequired,{globalPosition:globalPosition})),e&&(t.preventDefault(),$("#loader").removeClass("activate")),document.getElementById("exampleInputName1").addEventListener("input",(function(){this.classList.remove("is-invalid")}))})),$("#formSubmitCompany").click((function(t){$("#loader").addClass("activate"),document.getElementById("exampleInputName1").classList.remove("is-invalid");var e=!1,a=document.getElementById("exampleInputName1").value.trim(),n=$("#imageInput2").val();0===a.length?(e=!0,document.getElementById("exampleInputName1").classList.add("is-invalid"),$.notify(translations.fillCompanyName,{globalPosition:globalPosition})):a.length>35?(e=!0,document.getElementById("exampleInputName1").classList.add("is-invalid"),$.notify(translations.companyNameMax,{globalPosition:globalPosition})):""===n&&$(".forms-sample").hasClass("imageValidation")&&(e=!0,$.notify(translations.imageRequired,{globalPosition:globalPosition})),e&&(t.preventDefault(),$("#loader").removeClass("activate"))}))}));